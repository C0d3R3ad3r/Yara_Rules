rule ETERNALBLUE_SMB_EXPLOIT
{
	strings:
		$SMB_EXPLOIT1 = {89 EC 41 5F 41 5E 41 5D 41 5C 5E 5F 5D 5B C3 53 52 51 55 48 89 E5 48 81 EC 00 01 00 00 57 48 89 CF 48 89 D8 48 89 85 00 FF FF FF E8 BB 00 00 00 48 89 85 08 FF FF FF E8 48 01 00 00 48 89 85 10 FF FF FF 48 8B 85 00 FF FF FF 48 8B 8D 08 FF FF FF E8 9A 01 00 00 48 89 85 18 FF FF FF 48 8B 85 00 FF FF FF 48 8B 8D 08 FF FF FF E8 8F 01 00 00 48 89 85 20 FF FF FF 48 8B 85 00 FF FF FF 48 8B 8D 08 FF FF FF E8 84 01 00 00 48 89 85 28 FF FF FF 48 8B 85 00 FF FF FF 48 89 F9 48 8B 95 20 FF FF FF 48 8B 9D 10 FF FF FF E8 0F 01 00 00 48 89 85 30 FF FF FF 48 8B 85 28 FF FF FF 48 8B 8D 30 FF FF FF E8 55 01 00 00 66 89 C2 48 8B 85 00 FF FF FF 48 8B 8D 18 FF FF FF E8 49 01 00 00 5F 48 81 C4 00 01 00 00 5D 59 5A 5B C3 56 57}
		$SMB_EXPLOIT2 = {83 C6 04 E2 F8 48 01 D8 48 39 C6 7C 21 FF 55 4C E8 81 00 00 00 8B 45 44 D1 E8 48 31 C9 88 C1 48 01 E9 8B 09 31 C8 89 45 44 E8 43 00 00 00 B0 10 EB 08 B0 20 EB 04 B0 30 EB 00 48 8B 4D 28 B4 00 66 01 41 1E 48 8B 45 20 4C 89 F9 4C 89 E4 41 5F 41 5E 41 5D 41 5C 5D 5B 5E 5F FF 60 78 31 C0 88 C8 C1 E9 08 00 C8 C1 E9 08 00 C8 C1 E9 08 00 C8 C3 51 8B 45 44 89 C1 0F C9 D1 E0 31 C8 89 45 48 59 C3 51 E8 0E 00 00 00 48 8B 45 20 48 8B 48 78 48 89 48 70 59 C3 53 57 48 83 EC 28 48 8B 5D 4C 48 85 DB 74 13 31 C0 48 89 DF 48 31 C9 8B 4D 54 F3 AA 48 89 D9 FF 55 18 48 31 C0 89 45 54 48 89 45 4C 48 83 C4 28 5F 5B C3 51 56 57 48 8B 75 34 48 8B 0E E8 48 00 00 00 48 85 C0 75 11 48 8D 76 08 48 8B 0E E8 37 00 00 00 48 85 C0 74 2B 48 89 4D 34 6A 0C 58 48 8D B1 90 00 00 00 3B 06 74 08 48 83 C6 08 3B 06 75 11 3B 46 04 75 0C 48 89 75 3C 48 31 C0 48 FF C0 EB 03 48 31 C0 5F 5E 59 C3 48 31 C0 48 39 C1 7D 03 48 FF C0 C3}
	condition:
		all of them
}
