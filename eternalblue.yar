rule ETERNALBLUE_SMB_EXPLOIT
{
	strings:
		$SMB_EXPLOIT1 = {89EC415F 415E415D 415C5E5F 5D5BC353 52515548 89E54881 EC000100 00574889 CF4889D8 48898500 FFFFFFE8 BB000000 48898508 FFFFFFE8 48010000 48898510 FFFFFF48 8B8500FF FFFF488B 8D08FFFF FFE89A01 00004889 8518FFFF FF488B85 00FFFFFF 488B8D08 FFFFFFE8 8F010000 48898520 FFFFFF48 8B8500FF FFFF488B 8D08FFFF FFE88401 00004889 8528FFFF FF488B85 00FFFFFF 4889F948 8B9520FF FFFF488B 9D10FFFF FFE80F01 00004889 8530FFFF FF488B85 28FFFFFF 488B8D30 FFFFFFE8 55010000 6689C248 8B8500FF FFFF488B 8D18FFFF FFE84901 00005F48 81C40001 00005D59 5A5BC356 57}
		$SMB_EXPLOIT2 = {83C604E2 F84801D8 4839C67C 21FF554C E8810000 008B4544 D1E84831 C988C148 01E98B09 31C88945 44E84300 0000B010 EB08B020 EB04B030 EB00488B 4D28B400 6601411E 488B4520 4C89F94C 89E4415F 415E415D 415C5D5B 5E5FFF60 7831C088 C8C1E908 00C8C1E9 0800C8C1 E90800C8 C3518B45 4489C10F C9D1E031 C8894548 59C351E8 0E000000 488B4520 488B4878 48894870 59C35357 4883EC28 488B5D4C 4885DB74 1331C048 89DF4831 C98B4D54 F3AA4889 D9FF5518 4831C089 45544889 454C4883 C4285F5B C3515657 488B7534 488B0EE8 48000000 4885C075 11488D76 08488B0E E8370000 004885C0 742B4889 4D346A0C 58488DB1 90000000 3B067408 4883C608 3B067511 3B460475 0C488975 3C4831C0 48FFC0EB 034831C0 5F5E59C3 4831C048 39C17D03 48FFC0C3}
	condition:
		all of them
}